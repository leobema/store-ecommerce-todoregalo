<div class="grid grid-flow-col p-2 gap-5 justify-center">
<div class="justify-center">
  <div>
    <div class="mx-auto max-w-2xl bg-black rounded mt-5 mb-3 py-4 px-4">
        <button>
            <img routerLink="/tienda" class="h-10 w-max " src="./../../../../assets/images/logo-white.png"/>
        </button>
    </div>

<form action="javascript:voi(0)" (submit)="send()" method="POST" class="mx-auto max-w-2xl mt-5 mb-20 bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700 py-4 px-2" [formGroup]="formularioCompra">
  <div class="space-y-12">
    <div class="border-b border-gray-900/10 pb-12">
      <h2 class="text-2xl font-semibold leading-7 text-gray-900">DATOS PERSONALES</h2>
      <p class="mt-1 text-sm leading-6 text-gray-600"><span class=" text-red-500 font-bold">*Importante: </span>Si recibe una persona diferente a usted, por favor rellenar los datos de quien recibe.</p>

      <div class="mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6">
        <div class="sm:col-span-3">
          <label for="nombre" class="block text-sm font-medium leading-6 text-gray-900">Nombre</label>
          <div class="mt-2">
            <input type="text" name="Nombre" id="nombre" formControlName="nombre" autocomplete="given-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
          </div>
        </div>

        <div class="sm:col-span-3">
          <label for="apellido" class="block text-sm font-medium leading-6 text-gray-900">Apellido</label>
          <div class="mt-2">
            <input type="text" name="Apellido" id="apellido" formControlName="apellido" autocomplete="family-name" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
          </div>
        </div>

        <div class="sm:col-span-4">
          <label for="telf" class="block text-sm font-medium leading-6 text-gray-900">Teléfono</label>
          <div class="mt-2">
            <input id="telf" name="telf" type="tel" formControlName="telf" autocomplete="telf" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
          </div>
        </div>

        <div class="sm:col-span-3">
          <label for="email" class="block text-sm font-medium leading-6 text-gray-900">Email</label>
          <div class="mt-2">
            <input id="email" name="email" type="email" formControlName="email" autocomplete="email" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
          </div>
          <div class="flex h-6 items-center">
            <input id="emailNotification" name="emailNotification" type="checkbox" formControlName="emailNotification" class="mr-2 h-4 w-4 rounded border-gray-300">
                <div class="text-sm leading-6">
                    <label for="email-notification" class="font-base text-gray-900">Enviar datos de la compra a mi correo</label>
                </div>
          </div>
        </div>

        <div class="sm:col-span-4">
          <label for="envio" class="block text-sm font-medium leading-6 text-gray-900">Tipo de Envío</label>
          <div class="mt-2">
            <select 
            id="envio" 
            name="shipmentTypesValue" 
            formControlName="envio" 
            autocomplete="" 
            class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:max-w-xs sm:text-sm sm:leading-6"
            [(ngModel)]="shipmentTypesValue"
            >
            @for (type of shipmentTypes; track type.code) {
              <option [ngValue]="$index">
                {{ type.title }}
              </option>
            }
            </select>
            <label  class="block text-sm font-light leading-6 text-gray-900">
              Llega entre el 
              {{ shipmentSelected.averageDateRange[0] }} 
              y el {{ shipmentSelected.averageDateRange[1] }} por 
              <span class="text-lg font-sans">${{shipmentSelected.priceWithDiscount}} </span>
              <span class="line-through text-base text-opacity-70 text-gray-500">${{shipmentSelected.priceWithOutDiscount}}</span> 
              <br />
            </label>
          </div>
        </div>

        <div class="sm:col-span-4">
          <label for="provincia" class="block text-sm font-medium leading-6 text-gray-900">Provincia</label>
          <div class="mt-2">
            <select id="provincia" name="provincia" formControlName="provincia" autocomplete="Buenos Aires" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:max-w-xs sm:text-sm sm:leading-6">
              <option>Buenos Aires</option>
              <option>Buenos Aires Capital Federal</option>
              <option>Catamarca</option>
              <option>Chaco</option>
              <option>Chubut</option>
              <option>Córdoba</option>
              <option>Corrientes</option>
              <option>Entre Ríos</option>
              <option>Formosa</option>
              <option>Jujuy</option>
              <option>La Pampa</option>
              <option>La Rioja</option>
              <option>Mendoza</option>
              <option>Misiones</option>
              <option>Neuquen</option>
              <option>Río Negro</option>
              <option>Salta</option>
              <option>San Juan</option>
              <option>San Luís</option>
              <option>Santa Cruz</option>
              <option>Santa Fe</option>
              <option>Santiago del Estero</option>
              <option>Tierra del Fuego</option>
              <option>Tucumán</option>
            </select>
          </div>
        </div>

        <div class="col-span-full">
          <label for="direccion" class="block text-sm font-medium leading-6 text-gray-900">Dirección de envío</label>
          <div class="mt-2">
            <input type="text" name="direccion" id="direccion" formControlName="direccion" autocomplete="street-address" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
          </div>
        </div>

        <div class="sm:col-span-2 sm:col-start-1">
          <label for="ciudad" class="block text-sm font-medium leading-6 text-gray-900">Ciudad</label>
          <div class="mt-2">
            <input type="text" name="ciudad" id="ciudad" formControlName="ciudad" autocomplete="address-level2" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
          </div>
        </div>

        <div class="sm:col-span-2">
          <label for="localidad" class="block text-sm font-medium leading-6 text-gray-900">Localidad</label>
          <div class="mt-2">
            <input type="text" name="localidad" id="localidad" formControlName="localidad" autocomplete="address-level1" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
          </div>
        </div>

        <div class="sm:col-span-2">
          <label for="codigoPostal" class="block text-sm font-medium leading-6 text-gray-900">Codido Postal</label>
          <div class="mt-2">
            <input type="text" name="codigoPostal" id="codigoPostal" formControlName="codigoPostal" autocomplete="postal-code" class="block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
          </div>
        </div>
      </div>
    </div>
</div>

    <div class="mt-6 flex items-center justify-end gap-x-6">
        <button 
          type="button" 
          routerLink="/tienda" 
          class="text-sm font-semibold leading-6 text-gray-900">
          Cancel
        </button>
        <button  
            id="btn-pagar"
            value="submit" 
            type="submit" 
            onclick="createOrder()"
            [disabled]="!formularioCompra.valid" 
            (click)="changeLoading()"
            class="flex rounded-md bg-blue-500 px-2 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600">
            <svg 
            [class.hidden]="isLoading" 
            class="hidden absolute ml-10 animate-spin fill-white  h-5 w-5 ..." 
            viewBox="0 0 24 24">
            <path d="M13 23c0-.552-.448-1-1-1s-1 .448-1 1 .448 1 1 1 1-.448 1-1zm4.084-.834c0-.483-.393-.875-.875-.875s-.875.392-.875.875.393.875.875.875.875-.392.875-.875zm3.443-2.387c0-.414-.336-.75-.75-.75s-.75.336-.75.75.336.75.75.75.75-.336.75-.75zm2.343-3.568c0-.391-.317-.708-.708-.708s-.708.317-.708.708.317.708.708.708.708-.317.708-.708zm.796-4.209c0-.368-.298-.667-.666-.667s-.666.298-.666.667.298.667.666.667.666-.298.666-.667zm-.879-4.209c0-.345-.28-.625-.625-.625s-.625.28-.625.625.28.625.625.625.625-.279.625-.625zm-2.427-3.568c0-.322-.262-.583-.583-.583s-.583.261-.583.583.262.583.583.583.583-.261.583-.583zm-3.609-2.385c0-.299-.242-.542-.541-.542s-.541.242-.541.542.242.542.541.542.541-.243.541-.542zm-3.751-.84c0-.552-.448-1-1-1s-1 .448-1 1 .448 1 1 1 1-.448 1-1zm-4.21.838c0-.552-.448-1-1-1s-1 .448-1 1 .448 1 1 1 1-.448 1-1zm-3.569 2.385c0-.552-.448-1-1-1s-1 .448-1 1 .448 1 1 1 1-.448 1-1zm-2.384 3.57c0-.552-.448-1-1-1s-1 .448-1 1 .448 1 1 1 1-.447 1-1zm-.837 4.209c0-.552-.448-1-1-1s-1 .448-1 1 .448 1 1 1 1-.448 1-1zm.837 4.209c0-.552-.448-1-1-1s-1 .448-1 1 .448 1 1 1 1-.447 1-1zm2.384 3.569c0-.552-.448-1-1-1s-1 .448-1 1 .448 1 1 1 1-.447 1-1zm3.571 2.383c0-.552-.448-1-1-1s-1 .448-1 1 .448 1 1 1 1-.448 1-1z"/>
            </svg>
            Realizar Pedido            
        </button>
        <div id="wallet_container"></div>
        
    </div>


    
</form>
</div>
</div>

<div class="mx-auto bg-gray-100 rounded mt-5 mb-5 py-4 px-4">
  <div>
    <p>Detalle del Pedido</p>
    <div>
      @for (item of cart; track item; let i = $index) {
        <div>
          <div class="flex space-x2 items-center p-2 gap-2">
            <img class="w-12 h-12" [src]="item.product.images[0]" [alt]="item.product.title" >
            <h3 class="font-semibold">{{item.product.title}}</h3>
            <p>${{item.product.price}}</p>
            <svg
              class="h-3 w-3"
              fill="true"
              viewBox="0 0 24 24"
              stroke-width="0.75"
              stroke="black"
              aria-hidden="true">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="m12 10.93 5.719-5.72c.146-.146.339-.219.531-.219.404 0 .75.324.75.749 0 .193-.073.385-.219.532l-5.72 5.719 5.719 5.719c.147.147.22.339.22.531 0 .427-.349.75-.75.75-.192 0-.385-.073-.531-.219l-5.719-5.719-5.719 5.719c-.146.146-.339.219-.531.219-.401 0-.75-.323-.75-.75 0-.192.073-.384.22-.531l5.719-5.719-5.72-5.719c-.146-.147-.219-.339-.219-.532 0-.425.346-.749.75-.749.192 0 .385.073.531.219z"
                />
              </svg>
              <p class="font-semibold">{{item.cant}} </p>
            </div>
          </div>
        }
        <div class="ml-7 py-1 text-sm">
        Subtotal.: $ {{total()}}
        </div>
        <div class="flex gap-2 align-middle justify-center py-1 text-sm rounded-lg text-center bg-blue-200 w-[150px] font-semibold">
          <svg 
          class="h-6 w-6" 
          fill="none" 
          viewBox="0 0 24 24" 
          stroke-width="1.4"
           stroke="currentColor" 
           aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 18h-1c-.552 0-1-.448-1-1v-2h12v-9h4.667c1.117 0 1.6.576 1.936 1.107.594.94 1.536 2.432 2.109 3.378.188.312.288.67.288 1.035v4.48c0 1.121-.728 2-2 2h-1c0 1.656-1.344 3-3 3s-3-1.344-3-3h-4c0 1.656-1.344 3-3 3s-3-1.344-3-3zm3-1.2c.662 0 1.2.538 1.2 1.2 0 .662-.538 1.2-1.2 1.2-.662 0-1.2-.538-1.2-1.2 0-.662.538-1.2 1.2-1.2zm10 0c.662 0 1.2.538 1.2 1.2 0 .662-.538 1.2-1.2 1.2-.662 0-1.2-.538-1.2-1.2 0-.662.538-1.2 1.2-1.2zm-10-8.8h-8v-2h8v-1h-5v-1c0-.552.448-1 1-1h9c.552 0 1 .448 1 1v10h-11v-3h-2v-2h7v-1zm9 0v3h4.715l-1.427-2.496c-.178-.312-.509-.504-.868-.504h-2.42z" />
          </svg>
          Envío: $ {{shipmentSelected.priceWithDiscount}}
        </div>
        <div class="py-1 ml-3 font-semibold text-2xl">
          <hr />
          Total: $ {{totalWithDeliveried()}}
        </div>

        
  </div>
</div>
</div>


